mutate(Repeat = factor(Repeat),
Fold = factor(Fold)) %>%
ggplot(data=., mapping=aes(x = Sample_ID, y = Repeat, fill = Fold )) +
facet_grid(. ~ Diagnosis, scales="free") +
geom_tile() +
scale_fill_viridis_d() +
theme(axis.text.x = element_blank())
UCLA_CNP_catch22_fold_assignments %>%
filter(group_var == "ctx-lh-caudalanteriorcingulate") %>%
mutate(Repeat = factor(Repeat),
Fold = factor(Fold)) %>%
ggplot(data=., mapping=aes(x = Sample_ID, y = Repeat, fill = Fold )) +
facet_grid(. ~ Diagnosis, scales="free", space="free") +
geom_tile() +
xlab("Samples") +
ylab("CV-SVM Repeat") +
labs(fill = "k-fold") +
scale_fill_viridis_d() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.position = "bottom")
UCLA_CNP_catch22_fold_assignments %>%
filter(group_var == "ctx-lh-caudalanteriorcingulate") %>%
mutate(Repeat = factor(Repeat),
Fold = factor(Fold)) %>%
ggplot(data=., mapping=aes(x = Sample_ID, y = Repeat, fill = Fold )) +
facet_grid(. ~ Diagnosis, scales="free", space="free") +
geom_tile() +
xlab("Samples") +
ylab("CV-SVM Repeat") +
labs(fill = "k-fold") +
scale_fill_viridis_d() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.position = "bottom") +
guides(fill = guide_legend(title.position = "top",
# hjust = 0.5 centres the title horizontally
title.hjust = 0.5,
label.position = "bottom"))
UCLA_CNP_catch22_fold_assignments %>%
filter(group_var == "ctx-lh-caudalanteriorcingulate") %>%
mutate(Repeat = factor(Repeat),
Fold = factor(Fold)) %>%
ggplot(data=., mapping=aes(x = Sample_ID, y = Repeat, fill = Fold )) +
facet_grid(. ~ Diagnosis, scales="free", space="free") +
geom_tile() +
xlab("Samples") +
ylab("CV-SVM Repeat") +
labs(fill = "k-fold") +
scale_fill_viridis_d() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.position = "bottom") +
guides(fill = guide_legend(title.position = "top",
nrow = 1,
# hjust = 0.5 centres the title horizontally
title.hjust = 0.5,
label.position = "bottom"))
plot_path <- "~/github/fMRI_FeaturesDisorders/plots/Manuscript_Draft/FigureS7/"
TAF::mkdir(plot_path)
ggsave(glue("{plot_path}/UCLA_CNP_Univariate_catch22_robustsigmoid_scaler_fold_distributions.png"),
width = 7, height = 5, units="in", dpi=300)
ggsave(glue("{plot_path}/UCLA_CNP_Univariate_catch22_robustsigmoid_scaler_fold_distributions.png"),
width = 8, height = 4, units="in", dpi=300)
ggsave(glue("{plot_path}/UCLA_CNP_Univariate_catch22_robustsigmoid_scaler_fold_distributions.png"),
width = 7, height = 2.5, units="in", dpi=300)
ggsave(glue("{plot_path}/UCLA_CNP_Univariate_catch22_robustsigmoid_scaler_fold_distributions.png"),
width = 8, height = 3, units="in", dpi=300)
ggsave(glue("{plot_path}/UCLA_CNP_Univariate_catch22_left_caudal_anterior_cingulate_robustsigmoid_scaler_fold_distributions.png"),
width = 8, height = 3, units="in", dpi=300)
ABIDE_ASD_catch22_fold_assignments %>%
filter(group_var == "Superior Frontal Gyrus") %>%
mutate(Repeat = factor(Repeat),
Fold = factor(Fold)) %>%
ggplot(data=., mapping=aes(x = Sample_ID, y = Repeat, fill = Fold )) +
facet_grid(. ~ Diagnosis, scales="free", space="free") +
geom_tile() +
xlab("Samples") +
ylab("CV-SVM Repeat") +
labs(fill = "k-fold") +
scale_fill_viridis_d() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.position = "bottom") +
guides(fill = guide_legend(title.position = "top",
nrow = 1,
# hjust = 0.5 centres the title horizontally
title.hjust = 0.5,
label.position = "bottom"))
ggsave(glue("{plot_path}/ABIDE_ASD_Univariate_catch22_superior_frontal_gyrus_robustsigmoid_scaler_fold_distributions.png"),
width = 8, height = 3, units="in", dpi=300)
UCLA_CNP_catch22_fold_assignments %>%
mutate(num_samples = length(unique(Sample_ID))) %>%
group_by(group_var, Repeat) %>%
mutate(Control_Prop = sum(Diagnosis == "Control")/num_samples) %>%
group_by(group_var, Fold, Repeat, Control_Prop) %>%
summarise(num_subjects_in_test_fold = n(),
num_controls_in_test_fold = sum(Diagnosis == "Control"),
control_prop = num_controls_in_test_fold/num_subjects_in_test_fold)
UCLA_CNP_catch22_fold_assignments %>%
mutate(num_samples = length(unique(Sample_ID))) %>%
group_by(group_var, Repeat) %>%
mutate(Control_Prop = sum(Diagnosis == "Control")/num_samples) %>%
group_by(group_var, Fold, Repeat, Control_Prop) %>%
summarise(num_subjects_in_test_fold = n(),
num_controls_in_test_fold = sum(Diagnosis == "Control"),
control_prop_in_fold = num_controls_in_test_fold/num_subjects_in_test_fold) %>%
group_by(group_var, Control_Prop) %>%
summarise(mean_control_prop_across_folds = mean(control_prop_in_fold),
SD_control_prop_across_folds = sd(control_prop_in_fold))
UCLA_CNP_catch22_fold_assignments %>%
mutate(num_samples = length(unique(Sample_ID))) %>%
group_by(group_var, Repeat) %>%
mutate(Control_Prop = sum(Diagnosis == "Control")/num_samples) %>%
group_by(group_var, Fold, Repeat, Control_Prop) %>%
summarise(num_subjects_in_test_fold = n(),
num_controls_in_test_fold = sum(Diagnosis == "Control"),
control_prop_in_fold = num_controls_in_test_fold/num_subjects_in_test_fold) %>%
group_by(group_var, Control_Prop) %>%
summarise(mean_control_prop_across_folds = mean(control_prop_in_fold),
min_control_prop_across_folds = min(control_prop_in_fold),
max_control_prop_across_folds = max(control_prop_in_fold),
SD_control_prop_across_folds = sd(control_prop_in_fold))
UCLA_CNP_catch22_fold_assignments %>%
mutate(num_samples = length(unique(Sample_ID))) %>%
group_by(Repeat) %>%
mutate(Control_Prop = sum(Diagnosis == "Control")/num_samples) %>%
group_by(Fold, Repeat, Control_Prop) %>%
summarise(num_subjects_in_test_fold = n(),
num_controls_in_test_fold = sum(Diagnosis == "Control"),
control_prop_in_fold = num_controls_in_test_fold/num_subjects_in_test_fold) %>%
group_by(Control_Prop) %>%
summarise(mean_control_prop_across_folds = mean(control_prop_in_fold),
min_control_prop_across_folds = min(control_prop_in_fold),
max_control_prop_across_folds = max(control_prop_in_fold),
SD_control_prop_across_folds = sd(control_prop_in_fold))
UCLA_CNP_catch22_fold_assignments %>%
mutate(num_samples = length(unique(Sample_ID))) %>%
group_by(Repeat) %>%
mutate(Control_Prop = sum(Diagnosis == "Control")/num_samples)
UCLA_CNP_catch22_fold_assignments %>%
mutate(num_samples = length(unique(Sample_ID))) %>%
group_by(group_var, Repeat) %>%
mutate(Control_Prop = sum(Diagnosis == "Control")/num_samples) %>%
group_by(group_var, Fold, Repeat, Control_Prop) %>%
summarise(num_subjects_in_test_fold = n(),
num_controls_in_test_fold = sum(Diagnosis == "Control"),
control_prop_in_fold = num_controls_in_test_fold/num_subjects_in_test_fold) %>%
group_by(Control_Prop) %>%
summarise(mean_control_prop_across_folds = mean(control_prop_in_fold),
min_control_prop_across_folds = min(control_prop_in_fold),
max_control_prop_across_folds = max(control_prop_in_fold),
SD_control_prop_across_folds = sd(control_prop_in_fold))
UCLA_CNP_sample_metdata <- pyarrow_feather$read_feather(glue("{UCLA_CNP_data_path}/study_metadata/UCLA_CNP_sample_metadata.feather"))
ABIDE_ASD_sample_metdata <- pyarrow_feather$read_feather(glue("{ABIDE_ASD_data_path}/study_metadata/ABIDE_ASD_sample_metadata.feather"))
# Load fold assignments
UCLA_CNP_schizophrenia_catch22_fold_assignments <- pyarrow_feather$read_feather(glue("{UCLA_CNP_data_path}/processed_data/UCLA_CNP_Schizophrenia_Univariate_catch22_robustsigmoid_scaler_SVM_fold_assignments.feather")) %>%
left_join(., UCLA_CNP_sample_metdata)
UCLA_CNP_schizophrenia_catch22_fold_assignments <- pyarrow_feather$read_feather(glue("{UCLA_CNP_data_path}/processed_data/UCLA_CNP_Schizophrenia_Univariate_catch22_robustsigmoid_scaler_SVM_fold_assignments.feather")) %>%
left_join(., UCLA_CNP_sample_metdata)
UCLA_CNP_ADHD_catch22_fold_assignments <- pyarrow_feather$read_feather(glue("{UCLA_CNP_data_path}/processed_data/UCLA_CNP_ADHD_Univariate_catch22_robustsigmoid_scaler_SVM_fold_assignments.feather")) %>%
left_join(., UCLA_CNP_sample_metdata)
UCLA_CNP_bipolar_catch22_fold_assignments <- pyarrow_feather$read_feather(glue("{UCLA_CNP_data_path}/processed_data/UCLA_CNP_Bipolar_Univariate_catch22_robustsigmoid_scaler_SVM_fold_assignments.feather")) %>%
left_join(., UCLA_CNP_sample_metdata)
ABIDE_ASD_catch22_fold_assignments <- pyarrow_feather$read_feather(glue("{ABIDE_ASD_data_path}/processed_data/ABIDE_ASD_ASD_Univariate_catch22_robustsigmoid_scaler_SVM_fold_assignments.feather")) %>%
left_join(., ABIDE_ASD_sample_metdata)
UCLA_CNP_schizophrenia_catch22_fold_assignments %>%
filter(group_var == "ctx-lh-caudalanteriorcingulate") %>%
mutate(Repeat = factor(Repeat),
Fold = factor(Fold)) %>%
ggplot(data=., mapping=aes(x = Sample_ID, y = Repeat, fill = Fold )) +
facet_grid(. ~ Diagnosis, scales="free", space="free") +
geom_tile() +
xlab("Samples") +
ylab("CV-SVM Repeat") +
labs(fill = "k-fold") +
scale_fill_viridis_d() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.position = "bottom") +
guides(fill = guide_legend(title.position = "top",
nrow = 1,
# hjust = 0.5 centres the title horizontally
title.hjust = 0.5,
label.position = "bottom"))
ggsave(glue("{plot_path}/UCLA_CNP_Univariate_schizophrenia_catch22_left_caudal_anterior_cingulate_robustsigmoid_scaler_fold_distributions.png"),
width = 8, height = 3, units="in", dpi=300)
# UCLA CNP ADHD vs. control ctx-lh-caudalanteriorcingulate
UCLA_CNP_ADHD_catch22_fold_assignments %>%
filter(group_var == "ctx-lh-caudalanteriorcingulate") %>%
mutate(Repeat = factor(Repeat),
Fold = factor(Fold)) %>%
ggplot(data=., mapping=aes(x = Sample_ID, y = Repeat, fill = Fold )) +
facet_grid(. ~ Diagnosis, scales="free", space="free") +
geom_tile() +
xlab("Samples") +
ylab("CV-SVM Repeat") +
labs(fill = "k-fold") +
scale_fill_viridis_d() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.position = "bottom") +
guides(fill = guide_legend(title.position = "top",
nrow = 1,
# hjust = 0.5 centres the title horizontally
title.hjust = 0.5,
label.position = "bottom"))
ggsave(glue("{plot_path}/UCLA_CNP_Univariate_ADHD_catch22_left_caudal_anterior_cingulate_robustsigmoid_scaler_fold_distributions.png"),
width = 8, height = 3, units="in", dpi=300)
# UCLA CNP schizophrenia vs. control ctx-lh-caudalanteriorcingulate
UCLA_CNP_bipolar_catch22_fold_assignments %>%
filter(group_var == "ctx-lh-caudalanteriorcingulate") %>%
mutate(Repeat = factor(Repeat),
Fold = factor(Fold)) %>%
ggplot(data=., mapping=aes(x = Sample_ID, y = Repeat, fill = Fold )) +
facet_grid(. ~ Diagnosis, scales="free", space="free") +
geom_tile() +
xlab("Samples") +
ylab("CV-SVM Repeat") +
labs(fill = "k-fold") +
scale_fill_viridis_d() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.position = "bottom") +
guides(fill = guide_legend(title.position = "top",
nrow = 1,
# hjust = 0.5 centres the title horizontally
title.hjust = 0.5,
label.position = "bottom"))
ggsave(glue("{plot_path}/UCLA_CNP_Univariate_bipolar_catch22_left_caudal_anterior_cingulate_robustsigmoid_scaler_fold_distributions.png"),
width = 8, height = 3, units="in", dpi=300)
ABIDE_ASD_catch22_fold_assignments %>%
filter(group_var == "Superior Frontal Gyrus") %>%
mutate(Repeat = factor(Repeat),
Fold = factor(Fold)) %>%
ggplot(data=., mapping=aes(x = Sample_ID, y = Repeat, fill = Fold )) +
facet_grid(. ~ Diagnosis, scales="free", space="free") +
geom_tile() +
xlab("Samples") +
ylab("CV-SVM Repeat") +
labs(fill = "k-fold") +
scale_fill_viridis_d() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.position = "bottom") +
guides(fill = guide_legend(title.position = "top",
nrow = 1,
# hjust = 0.5 centres the title horizontally
title.hjust = 0.5,
label.position = "bottom"))
ggsave(glue("{plot_path}/ABIDE_ASD_Univariate_catch22_superior_frontal_gyrus_robustsigmoid_scaler_fold_distributions.png"),
width = 8, height = 3, units="in", dpi=300)
UCLA_CNP_ADHD_catch22_fold_assignments %>%
mutate(num_samples = length(unique(Sample_ID))) %>%
group_by(group_var, Repeat) %>%
mutate(Control_Prop = sum(Diagnosis == "Control")/num_samples) %>%
group_by(group_var, Fold, Repeat, Control_Prop) %>%
summarise(num_subjects_in_test_fold = n(),
num_controls_in_test_fold = sum(Diagnosis == "Control"),
control_prop_in_fold = num_controls_in_test_fold/num_subjects_in_test_fold) %>%
group_by(Control_Prop) %>%
summarise(mean_control_prop_across_folds = 100*mean(control_prop_in_fold),
min_control_prop_across_folds = 100*min(control_prop_in_fold),
max_control_prop_across_folds = 100*max(control_prop_in_fold),
SD_control_prop_across_folds = 100*sd(control_prop_in_fold))
UCLA_CNP_ADHD_catch22_fold_assignments %>%
mutate(num_samples = length(unique(Sample_ID))) %>%
group_by(group_var, Repeat) %>%
mutate(Control_Prop = sum(Diagnosis == "Control")/num_samples) %>%
group_by(group_var, Fold, Repeat, Control_Prop) %>%
summarise(num_subjects_in_test_fold = n(),
num_controls_in_test_fold = sum(Diagnosis == "Control"),
control_prop_in_fold = num_controls_in_test_fold/num_subjects_in_test_fold) %>%
group_by(Control_Prop) %>%
summarise(mean_control_prop_across_folds = 100*mean(control_prop_in_fold),
SD_control_prop_across_folds = 100*sd(control_prop_in_fold),
min_control_prop_across_folds = 100*min(control_prop_in_fold),
max_control_prop_across_folds = 100*max(control_prop_in_fold)
)
UCLA_CNP_catch22_fold_assignments %>%
mutate(num_samples = length(unique(Sample_ID))) %>%
group_by(group_var, Repeat) %>%
mutate(Control_Prop = sum(Diagnosis == "Control")/num_samples) %>%
group_by(group_var, Fold, Repeat, Control_Prop) %>%
summarise(num_subjects_in_test_fold = n(),
num_controls_in_test_fold = sum(Diagnosis == "Control"),
control_prop_in_fold = num_controls_in_test_fold/num_subjects_in_test_fold) %>%
group_by(Control_Prop) %>%
summarise(mean_control_prop_across_folds = 100*mean(control_prop_in_fold),
SD_control_prop_across_folds = 100*sd(control_prop_in_fold),
min_control_prop_across_folds = 100*min(control_prop_in_fold),
max_control_prop_across_folds = 100*max(control_prop_in_fold)
)
UCLA_CNP_bipolarcatch22_fold_assignments %>%
mutate(num_samples = length(unique(Sample_ID))) %>%
group_by(group_var, Repeat) %>%
mutate(Control_Prop = sum(Diagnosis == "Control")/num_samples) %>%
group_by(group_var, Fold, Repeat, Control_Prop) %>%
summarise(num_subjects_in_test_fold = n(),
num_controls_in_test_fold = sum(Diagnosis == "Control"),
control_prop_in_fold = num_controls_in_test_fold/num_subjects_in_test_fold) %>%
group_by(Control_Prop) %>%
summarise(mean_control_prop_across_folds = 100*mean(control_prop_in_fold),
SD_control_prop_across_folds = 100*sd(control_prop_in_fold),
min_control_prop_across_folds = 100*min(control_prop_in_fold),
max_control_prop_across_folds = 100*max(control_prop_in_fold)
)
UCLA_CNP_bipolar_catch22_fold_assignments %>%
mutate(num_samples = length(unique(Sample_ID))) %>%
group_by(group_var, Repeat) %>%
mutate(Control_Prop = sum(Diagnosis == "Control")/num_samples) %>%
group_by(group_var, Fold, Repeat, Control_Prop) %>%
summarise(num_subjects_in_test_fold = n(),
num_controls_in_test_fold = sum(Diagnosis == "Control"),
control_prop_in_fold = num_controls_in_test_fold/num_subjects_in_test_fold) %>%
group_by(Control_Prop) %>%
summarise(mean_control_prop_across_folds = 100*mean(control_prop_in_fold),
SD_control_prop_across_folds = 100*sd(control_prop_in_fold),
min_control_prop_across_folds = 100*min(control_prop_in_fold),
max_control_prop_across_folds = 100*max(control_prop_in_fold)
)
ABIDE_ASD_catch22_fold_assignments %>%
mutate(num_samples = length(unique(Sample_ID))) %>%
group_by(group_var, Repeat) %>%
mutate(Control_Prop = sum(Diagnosis == "Control")/num_samples) %>%
group_by(group_var, Fold, Repeat, Control_Prop) %>%
summarise(num_subjects_in_test_fold = n(),
num_controls_in_test_fold = sum(Diagnosis == "Control"),
control_prop_in_fold = num_controls_in_test_fold/num_subjects_in_test_fold) %>%
group_by(Control_Prop) %>%
summarise(mean_control_prop_across_folds = 100*mean(control_prop_in_fold),
min_control_prop_across_folds = 100*min(control_prop_in_fold),
max_control_prop_across_folds = 100*max(control_prop_in_fold),
SD_control_prop_across_folds = 100*sd(control_prop_in_fold))
library(patchwork)
UCLA_scz_heatmap <- UCLA_CNP_schizophrenia_catch22_fold_assignments %>%
filter(group_var == "ctx-lh-caudalanteriorcingulate") %>%
mutate(Repeat = factor(Repeat),
Fold = factor(Fold)) %>%
ggplot(data=., mapping=aes(x = Sample_ID, y = Repeat, fill = Fold )) +
facet_grid(. ~ Diagnosis, scales="free", space="free") +
geom_tile() +
xlab("Samples") +
ylab("CV-SVM Repeat") +
labs(fill = "k-fold") +
scale_fill_viridis_d() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.position = "bottom") +
guides(fill = guide_legend(title.position = "top",
nrow = 1,
# hjust = 0.5 centres the title horizontally
title.hjust = 0.5,
label.position = "bottom"))
UCLA_ADHD_heatmap <- UCLA_CNP_ADHD_catch22_fold_assignments %>%
filter(group_var == "ctx-lh-caudalanteriorcingulate") %>%
mutate(Repeat = factor(Repeat),
Fold = factor(Fold)) %>%
ggplot(data=., mapping=aes(x = Sample_ID, y = Repeat, fill = Fold )) +
facet_grid(. ~ Diagnosis, scales="free", space="free") +
geom_tile() +
xlab("Samples") +
ylab("CV-SVM Repeat") +
labs(fill = "k-fold") +
scale_fill_viridis_d() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.position = "bottom") +
guides(fill = guide_legend(title.position = "top",
nrow = 1,
# hjust = 0.5 centres the title horizontally
title.hjust = 0.5,
label.position = "bottom"))
UCLA_bipolar_heatmap <- UCLA_CNP_bipolar_catch22_fold_assignments %>%
filter(group_var == "ctx-lh-caudalanteriorcingulate") %>%
mutate(Repeat = factor(Repeat),
Fold = factor(Fold)) %>%
ggplot(data=., mapping=aes(x = Sample_ID, y = Repeat, fill = Fold )) +
facet_grid(. ~ Diagnosis, scales="free", space="free") +
geom_tile() +
xlab("Samples") +
ylab("CV-SVM Repeat") +
labs(fill = "k-fold") +
scale_fill_viridis_d() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
legend.position = "bottom") +
guides(fill = guide_legend(title.position = "top",
nrow = 1,
# hjust = 0.5 centres the title horizontally
title.hjust = 0.5,
label.position = "bottom"))
# UCLA CNP schizophrenia vs. control ctx-lh-caudalanteriorcingulate
UCLA_scz_heatmap <- UCLA_CNP_schizophrenia_catch22_fold_assignments %>%
filter(group_var == "ctx-lh-caudalanteriorcingulate") %>%
mutate(Repeat = factor(Repeat),
Fold = factor(Fold)) %>%
ggplot(data=., mapping=aes(x = Sample_ID, y = Repeat, fill = Fold )) +
facet_grid(. ~ Diagnosis, scales="free", space="free") +
geom_tile() +
xlab("Samples") +
ylab("CV-SVM Repeat") +
labs(fill = "k-fold") +
ggtitle("UCLA CNP -- Schizophrenia") +
scale_fill_viridis_d() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
plot.title = element_text(hjust=0.5),
legend.position = "bottom") +
guides(fill = guide_legend(title.position = "top",
nrow = 1,
# hjust = 0.5 centres the title horizontally
title.hjust = 0.5,
label.position = "bottom"))
# ggsave(glue("{plot_path}/UCLA_CNP_Univariate_schizophrenia_catch22_left_caudal_anterior_cingulate_robustsigmoid_scaler_fold_distributions.png"),
#        width = 8, height = 3, units="in", dpi=300)
# UCLA CNP ADHD vs. control ctx-lh-caudalanteriorcingulate
UCLA_ADHD_heatmap <- UCLA_CNP_ADHD_catch22_fold_assignments %>%
filter(group_var == "ctx-lh-caudalanteriorcingulate") %>%
mutate(Repeat = factor(Repeat),
Fold = factor(Fold)) %>%
ggplot(data=., mapping=aes(x = Sample_ID, y = Repeat, fill = Fold )) +
facet_grid(. ~ Diagnosis, scales="free", space="free") +
geom_tile() +
xlab("Samples") +
ylab("CV-SVM Repeat") +
labs(fill = "k-fold") +
ggtitle("UCLA CNP -- ADHD") +
scale_fill_viridis_d() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
plot.title = element_text(hjust=0.5),
legend.position = "bottom") +
guides(fill = guide_legend(title.position = "top",
nrow = 1,
# hjust = 0.5 centres the title horizontally
title.hjust = 0.5,
label.position = "bottom"))
# ggsave(glue("{plot_path}/UCLA_CNP_Univariate_ADHD_catch22_left_caudal_anterior_cingulate_robustsigmoid_scaler_fold_distributions.png"),
#        width = 8, height = 3, units="in", dpi=300)
# UCLA CNP schizophrenia vs. control ctx-lh-caudalanteriorcingulate
UCLA_bipolar_heatmap <- UCLA_CNP_bipolar_catch22_fold_assignments %>%
filter(group_var == "ctx-lh-caudalanteriorcingulate") %>%
mutate(Repeat = factor(Repeat),
Fold = factor(Fold)) %>%
ggplot(data=., mapping=aes(x = Sample_ID, y = Repeat, fill = Fold )) +
facet_grid(. ~ Diagnosis, scales="free", space="free") +
geom_tile() +
xlab("Samples") +
ylab("CV-SVM Repeat") +
labs(fill = "k-fold") +
ggtitle("UCLA CNP -- Bipolar") +
scale_fill_viridis_d() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
plot.title = element_text(hjust=0.5),
legend.position = "bottom") +
guides(fill = guide_legend(title.position = "top",
nrow = 1,
# hjust = 0.5 centres the title horizontally
title.hjust = 0.5,
label.position = "bottom"))
# ggsave(glue("{plot_path}/UCLA_CNP_Univariate_bipolar_catch22_left_caudal_anterior_cingulate_robustsigmoid_scaler_fold_distributions.png"),
#        width = 8, height = 3, units="in", dpi=300)
# Use ABIDE ASD vs. control Superior Frontal Gyrus as example
ABIDE_ASD_heatmap <- ABIDE_ASD_catch22_fold_assignments %>%
filter(group_var == "Superior Frontal Gyrus") %>%
mutate(Repeat = factor(Repeat),
Fold = factor(Fold)) %>%
ggplot(data=., mapping=aes(x = Sample_ID, y = Repeat, fill = Fold )) +
facet_grid(. ~ Diagnosis, scales="free", space="free") +
geom_tile() +
xlab("Samples") +
ylab("CV-SVM Repeat") +
labs(fill = "k-fold") +
ggtitle("ABIDE -- ASD") +
scale_fill_viridis_d() +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
plot.title = element_text(hjust=0.5),
legend.position = "bottom") +
guides(fill = guide_legend(title.position = "top",
nrow = 1,
# hjust = 0.5 centres the title horizontally
title.hjust = 0.5,
label.position = "bottom"))
wrap_plots(list(UCLA_scz_heatmap,
UCLA_ADHD_heatmap,
UCLA_bipolar_heatmap,
ABIDE_ASD_heatmap),
ncol = 2)
wrap_plots(list(UCLA_scz_heatmap,
UCLA_ADHD_heatmap,
UCLA_bipolar_heatmap,
ABIDE_ASD_heatmap),
ncol = 2) +
plot_layout(guides = "collect") & theme(legend.position = 'bottom')
wrap_plots(list(UCLA_scz_heatmap,
UCLA_ADHD_heatmap,
UCLA_bipolar_heatmap,
ABIDE_ASD_heatmap),
ncol = 2)
ggsave(glue("{plot_path}/All_catch22_robustsigmoid_scaler_fold_distributions.png"),
width = 12, height = 5, units="in", dpi=300)
wrap_plots(list(UCLA_scz_heatmap,
UCLA_ADHD_heatmap,
UCLA_bipolar_heatmap,
ABIDE_ASD_heatmap),
ncol = 2) +
plot_layout(guides = "collect") & theme(legend.position = 'bottom')
ggsave(glue("{plot_path}/All_catch22_robustsigmoid_scaler_fold_distributions.png"),
width = 12, height = 5, units="in", dpi=300)
