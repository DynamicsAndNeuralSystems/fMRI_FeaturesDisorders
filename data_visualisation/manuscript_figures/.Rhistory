install.packages("ggseg")
install.packages("ggseg")
library(rgdal)
install.packages("rgdal")
setwd("~/github/fMRI_FeaturesDisorders/data_visualisation/manuscript_figures")
install.packages("ggseg3d")
library(tidyverse)
library(ggseg3d)
library(icesTAF)
library(cowplot)
theme_set(theme_cowplot())
github_dir <- "~/github/fMRI_FeaturesDisorders/"
plot_path <- paste0(github_dir, "plots/Manuscript_Draft/")
icesTAF::mkdir(plot_path)
################################################################################
# Figure 1: methods overview
################################################################################
icesTAF::mkdir(paste0(plot_path, "Figure1/"))
data.frame(
region = c("inferior parietal",
"rostral middle frontal"),
p = c(0, 1),
stringsAsFactors = F) %>%
ggseg3d(colour = "p", text = "p",
palette = c("deepskyblue2" = 0 ,
"darkorange2" = 1),
show.legend=F) %>%
remove_axes() %>%
pan_camera("left medial")
set.seed(127)
ar.sim1<-arima.sim(model=list(ar=c(.9,-.2)),n=80)
ar.sim2 <- arima.sim(model=list(ar=c(0.3, 0.1)), n=80)
#Our transformation function
scaleFUN <- function(x) sprintf("%.1f", x)
# Inferior parietal (blue)
data.frame(Time = 1:length(ar.sim1),
BOLD = as.numeric(ar.sim1),
Time_Series = "TS1") %>%
ggplot(data=., mapping=aes(x=Time, y=BOLD, color=Time_Series)) +
geom_line(size=0.6, alpha=0.9) +
scale_color_manual(values=c("deepskyblue2")) +
scale_y_continuous(labels=scaleFUN) +
theme(legend.position="none")
ggsave(paste0(plot_path, "Figure1/BOLD_TS_blue.png"), width=2.3, height=1.8,
units="in", dpi=1200, bg = "transparent")
data.frame(Time = 1:length(ar.sim1),
BOLD = as.numeric(ar.sim1),
Time_Series = "TS1")
data.frame(Time = 1:length(ar.sim1),
BOLD = as.numeric(ar.sim1),
Time_Series = "TS1") %>%
ggplot(data=., mapping=aes(x=Time, y=BOLD, color=Time_Series)) +
geom_line(size=0.6, alpha=0.9)
ar.sim1
ar.sim1
data.frame(Time = 1:length(ar.sim1),
BOLD = as.numeric(ar.sim1),
Time_Series = "TS1") %>%
ggplot(data=., mapping=aes(x=Time, y=BOLD, color=Time_Series)) +
geom_line()
data.frame(Time = 1:length(ar.sim1),
BOLD = as.numeric(ar.sim1),
Time_Series = "TS1") %>%
ggplot(data=., mapping=aes(x=Time, y=BOLD, color=Time_Series)) +
geom_line(size=0.6, alpha=0.9)
data.frame(Time = 1:length(ar.sim2),
BOLD = as.numeric(ar.sim2),
Time_Series = "TS2") %>%
ggplot(data=., mapping=aes(x=Time, y=BOLD, color=Time_Series)) +
geom_line(size=0.6, alpha=0.9) +
scale_color_manual(values=c("darkorange2")) +
scale_y_continuous(labels=scaleFUN) +
theme(legend.position="none")
ggsave(paste0(plot_path, "Figure1/BOLD_TS_orange.png"), width=2.3, height=1.8,
units="in", dpi=1200, bg = "transparent")
data.frame(Time = c(1:length(ar.sim1), 1:length(ar.sim2)),
BOLD = c(as.numeric(ar.sim1), as.numeric(ar.sim2)),
Time_Series = c(rep("TS1", length(ar.sim1)),
rep("TS2", length(ar.sim2)))) %>%
ggplot(data=., mapping=aes(x=Time, y=BOLD, color=Time_Series)) +
geom_line(size=0.6, alpha=0.9) +
scale_color_manual(values=c("deepskyblue2", "darkorange2")) +
scale_y_continuous(labels=scaleFUN) +
theme(legend.position="none")
ggsave(paste0(plot_path, "Figure1/BOLD_TS_both.png"), width=2.3, height=1.8,
units="in", dpi=1200, bg = "transparent")
icesTAF::mkdir(paste0(plot_path, "Figure2/"))
SCZ_data_path <- "~/data/UCLA_Schizophrenia/"
SCZ_rdata_path <- paste0(SCZ_data_path, "processed_data/Rdata/")
ASD_data_path <- "~/data/ABIDE_ASD/"
ASD_rdata_path <- paste0(ASD_data_path, "processed_data/Rdata/")
raw_ASD_pyspi_res <- readRDS(paste0(ASD_rdata_path, "ABIDE_ASD_pyspi14_filtered.Rds"))
raw_ASD_pyspi_res %>%
filter(brain_region_1 != brain_region_2) %>%
distinct(brain_region_1, brain_region_2)
raw_ASD_pyspi_res %>%
filter(brain_region_1 != brain_region_2) %>%
distinct(brain_region_1, brain_region_2) %>%
nrow()
unique(raw_ASD_pyspi_res$SPI)
summary(raw_ASD_pyspi_res[raw_ASD_pyspi_res$SPI=="sgc_nonparametric_mean_fs-1_fmin-0_fmax-0-5"])
summary(subset(raw_ASD_pyspi_res, SPI=="sgc_nonparametric_mean_fs-1_fmin-0_fmax-0-5"))
raw_ASD_pyspi_res %>%
filter(SPI=="sgc_nonparametric_mean_fs-1_fmin-0_fmax-0-5")
raw_ASD_pyspi_res %>%
filter(brain_region_1 != brain_region_2) %>%
filter(SPI=="sgc_nonparametric_mean_fs-1_fmin-0_fmax-0-5") %>%
filter(is.na(value))
raw_ASD_pyspi_res %>%
filter(brain_region_1 != brain_region_2) %>%
filter(SPI=="sgc_nonparametric_mean_fs-1_fmin-0_fmax-0-5") %>%
filter(is.na(value)) %>%
distinct(Sample_ID)
NA_sgc_res <- raw_ASD_pyspi_res %>%
filter(brain_region_1 != brain_region_2) %>%
filter(SPI=="sgc_nonparametric_mean_fs-1_fmin-0_fmax-0-5") %>%
filter(is.na(value))
View(NA_sgc_res)
sgc_res <- raw_ASD_pyspi_res %>%
filter(brain_region_1 != brain_region_2) %>%
filter(SPI=="sgc_nonparametric_mean_fs-1_fmin-0_fmax-0-5")
sgc_res_NA <-  sgc_res %>%
filter(is.na(value))
sgc_res_NA %>%
distinct(brain_region_1, brain_region_2)
sgc_res_NA %>%
mutate(region_pair = paste0(brain_region_1, "_", brain_region_2)) %>%
ggplot(data=., mapping=aes(x=region_pair, y=Sample_ID, fill=value)) +
geom_tile() +
theme(axis.text = element_blank(),
legend.position = "none")
