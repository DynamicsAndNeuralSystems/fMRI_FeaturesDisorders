View(ROI_data)
merged_data <- do.call(plyr::rbind.fill, list(ROI_data, combo_data)) %>%
mutate( Analysis = factor(Analysis, levels = c("Region-wise",
"Combo-wise")))
View(merged_data)
region_fill_color = "#F0224B"
combo_fill_color = "#9B51B4"
merged_data %>%
ggplot(data=., mapping = aes(x = Analysis, y = balanced_accuracy)) +
geom_violin(aes(fill = Analysis)) +
stat_summary(data = subset(merged_data, Analysis == "Combo-wise"),
geom = "crossbar", fun = "mean", aes(color=Analysis), size=1,
color = combo_fill_color) +
geom_boxplot(fill=NA, width=0.1, color="black") +
scale_x_discrete(labels = function(x) str_wrap(x, width = 15)) +
scale_fill_manual(values = c(region_fill_color)) +
ylab("Balanced Accuracy") +
theme(legend.position = "none",
strip.placement = "outside",
strip.background = element_blank(),
strip.text.y.left = element_blank(),
axis.title.x = element_blank())
plot_univar_region_vs_combo_violin <- function(dataset_ID,
ROI_data_full,
ROI_pvals,
combo_data,
region_fill_color = "#F0224B",
combo_fill_color = "#9B51B4") {
# Get average of all brain regions, first by repeat and then across repeats
ROI_data <- ROI_data_full %>%
group_by(grouping_var, Noise_Proc, repeat_number) %>%
summarise(mean_balacc = mean(balanced_accuracy, na.rm=T)) %>%
group_by(grouping_var, Noise_Proc) %>%
summarise(balanced_accuracy = mean(mean_balacc, na.rm=T)) %>%
left_join(., ROI_pvals)
ROI_data$Analysis <- "Region-wise"
combo_data$Analysis <- "Combo-wise"
merged_data <- do.call(plyr::rbind.fill, list(ROI_data, combo_data)) %>%
mutate( Analysis = factor(Analysis, levels = c("Region-wise",
"Combo-wise")))
merged_data %>%
ggplot(data=., mapping = aes(x = Analysis, y = balanced_accuracy)) +
geom_violin(aes(fill = Analysis)) +
stat_summary(data = subset(merged_data, Analysis == "Combo-wise"),
geom = "crossbar", fun = "mean", aes(color=Analysis), size=1,
color = combo_fill_color) +
geom_boxplot(fill=NA, width=0.1, color="black") +
scale_x_discrete(labels = function(x) str_wrap(x, width = 15)) +
scale_fill_manual(values = c(region_fill_color)) +
ylab("Balanced Accuracy") +
theme(legend.position = "none",
strip.placement = "outside",
strip.background = element_blank(),
strip.text.y.left = element_blank(),
axis.title.x = element_blank())
}
plot_univar_region_vs_combo_violin(dataset_ID = "UCLA_Schizophrenia",
ROI_data_full = UCLA_ROI_main_full,
ROI_pvals = UCLA_ROI_pvals,
combo_data = UCLA_combo_main,
region_fill_color = "#F0224B",
combo_fill_color = "#9B51B4")
plot_univar_region_vs_combo_violin(dataset_ID = "UCLA_Schizophrenia",
ROI_data_full = UCLA_ROI_main_full,
ROI_pvals = UCLA_ROI_pvals,
combo_data = UCLA_combo_main,
region_fill_color = "#F0224B",
combo_fill_color = "#9B51B4")
ggsave(paste0(plot_path, "Figure2/UCLA_Univariate_Comparison_Boxplot.png"),
width = 3, height = 2.75, units = "in", dpi = 300)
plot_univar_region_vs_combo_violin(dataset_ID = "ABIDE_ASD",
ROI_data_full = ABIDE_ROI_main_full,
ROI_pvals = ABIDE_ROI_pvals,
combo_data = ABIDE_combo_main,
region_fill_color = "#F0224B",
combo_fill_color = "#9B51B4")
ggsave(paste0(plot_path, "Figure2/ABIDE_Univariate_Comparison_Boxplot.png"),
width = 3, height = 2.75, units = "in", dpi = 300)
UCLA_SPI_pvals <- readRDS(paste0(UCLA_rdata_path, "SPI_wise_CV_linear_SVM_model_permutation_null_pyspi14_inv_prob_pvals.Rds")) %>%
filter(Noise_Proc == "AROMA+2P+GMR") %>%
ungroup() %>%
mutate(bal_acc_p_adj_bonf = p.adjust(bal_acc_p, method="bonferroni")) %>%
dplyr::select(grouping_var, bal_acc_p, bal_acc_p_adj, bal_acc_p_adj_bonf)
# ABIDE ASD
ABIDE_SPI_pvals <- readRDS(paste0(ABIDE_rdata_path, "SPI_wise_CV_linear_SVM_model_permutation_null_pyspi14_inv_prob_pvals.Rds")) %>%
filter(Noise_Proc == "FC1000") %>%
ungroup() %>%
mutate(bal_acc_p_adj_bonf = p.adjust(bal_acc_p, method="bonferroni")) %>%
dplyr::select(grouping_var, bal_acc_p, bal_acc_p_adj, bal_acc_p_adj_bonf)
# UCLA Schizophrenia
UCLA_SPI_main_full <- readRDS(paste0(UCLA_rdata_path, "SPI_wise_CV_linear_SVM_pyspi14_inv_prob_balacc.Rds"))%>%
filter(Noise_Proc == "AROMA+2P+GMR")
# ABIDE ASD
ABIDE_SPI_main_full <- readRDS(paste0(ABIDE_rdata_path, "SPI_wise_CV_linear_SVM_pyspi14_inv_prob_balacc.Rds")) %>%
filter(Noise_Proc == "FC1000")
UCLA_SPI_main_full %>%
group_by(grouping_var, Sample_Type, Noise_Proc, repeat_number) %>%
summarise(mean_balanced_accuracy = mean(balanced_accuracy, na.rm=T)) %>%
dplyr::rename("balanced_accuracy" = "mean_balanced_accuracy") %>%
left_join(., UCLA_SPI_pvals) %>%
mutate(grouping_var = fct_reorder(grouping_var,
balanced_accuracy,
.fun = mean))
UCLA_SPI_main_repeats <- UCLA_SPI_main_full %>%
group_by(grouping_var, Sample_Type, Noise_Proc, repeat_number) %>%
summarise(mean_balanced_accuracy = mean(balanced_accuracy, na.rm=T)) %>%
dplyr::rename("balanced_accuracy" = "mean_balanced_accuracy") %>%
left_join(., UCLA_SPI_pvals) %>%
mutate(grouping_var = fct_reorder(grouping_var,
balanced_accuracy,
.fun = mean))
# ABIDE ASD
ABIDE_SPI_main_repeats <- ABIDE_SPI_main_full %>%
group_by(grouping_var, Sample_Type, Noise_Proc, repeat_number) %>%
summarise(mean_balanced_accuracy = mean(balanced_accuracy, na.rm=T)) %>%
dplyr::rename("balanced_accuracy" = "mean_balanced_accuracy") %>%
left_join(., ABIDE_SPI_pvals) %>%
mutate(grouping_var = fct_reorder(grouping_var,
balanced_accuracy,
.fun = mean))
UCLA_SPI_main_repeats %>%
group_by(grouping_var, Sample_Type, Noise_Proc) %>%
summarise(mean_balanced_accuracy = mean(balanced_accuracy, na.rm=T),
mean_SD = sd(balanced_accuracy, na.rm=T)) %>%
dplyr::rename("balanced_accuracy" = "mean_balanced_accuracy") %>%
left_join(., UCLA_SPI_pvals) %>%
ungroup() %>%
mutate(grouping_var = fct_reorder(grouping_var,
balanced_accuracy,
.fun = mean))
UCLA_SPI_main <- UCLA_SPI_main_repeats %>%
group_by(grouping_var, Sample_Type, Noise_Proc) %>%
summarise(mean_balanced_accuracy = mean(balanced_accuracy, na.rm=T),
mean_SD = sd(balanced_accuracy, na.rm=T)) %>%
dplyr::rename("balanced_accuracy" = "mean_balanced_accuracy") %>%
left_join(., UCLA_SPI_pvals) %>%
ungroup() %>%
mutate(grouping_var = fct_reorder(grouping_var,
balanced_accuracy,
.fun = mean))
# ABIDE ASD
ABIDE_SPI_main <- ABIDE_SPI_main_repeats %>%
group_by(grouping_var, Sample_Type, Noise_Proc) %>%
summarise(mean_balanced_accuracy = mean(balanced_accuracy, na.rm=T),
mean_SD = sd(balanced_accuracy, na.rm=T)) %>%
dplyr::rename("balanced_accuracy" = "mean_balanced_accuracy") %>%
left_join(., ABIDE_SPI_pvals) %>%
ungroup() %>%
mutate(grouping_var = fct_reorder(grouping_var,
balanced_accuracy,
.fun = mean))
UCLA_SPI_null <- readRDS(paste0(UCLA_rdata_path, "UCLA_Schizophrenia_SPI_wise_model_permutation_null_pyspi14_inv_prob.Rds"))
# ABIDE ASD
ABIDE_SPI_null <- readRDS(paste0(ABIDE_rdata_path, "ABIDE_ASD_SPI_wise_model_permutation_null_pyspi14_inv_prob.Rds"))
plot_boxplot_shaded_null(dataset_ID = "UCLA_Schizophrenia",
grouping_var_name = "SPI",
main_data_by_repeat = UCLA_SPI_main_repeats,
fill_color = "chartreuse3",
null_mean_value = mean(UCLA_SPI_null$balanced_accuracy, na.rm=T),
null_SD_value = sd(UCLA_SPI_null$balanced_accuracy, na.rm=T))
# UCLA Schizophrenia
UCLA_SPI_main_repeats <- UCLA_SPI_main_full %>%
group_by(grouping_var, Sample_Type, Noise_Proc, repeat_number) %>%
summarise(mean_balanced_accuracy = mean(balanced_accuracy, na.rm=T)) %>%
dplyr::rename("balanced_accuracy" = "mean_balanced_accuracy") %>%
left_join(., UCLA_SPI_pvals) %>%
filter(bal_acc_p_adj < 0.05) %>%
mutate(grouping_var = fct_reorder(grouping_var,
balanced_accuracy,
.fun = mean))
# ABIDE ASD
ABIDE_SPI_main_repeats <- ABIDE_SPI_main_full %>%
group_by(grouping_var, Sample_Type, Noise_Proc, repeat_number) %>%
summarise(mean_balanced_accuracy = mean(balanced_accuracy, na.rm=T)) %>%
dplyr::rename("balanced_accuracy" = "mean_balanced_accuracy") %>%
left_join(., ABIDE_SPI_pvals) %>%
filter(bal_acc_p_adj < 0.05) %>%
mutate(grouping_var = fct_reorder(grouping_var,
balanced_accuracy,
.fun = mean))
UCLA_SPI_main <- UCLA_SPI_main_repeats %>%
group_by(grouping_var, Sample_Type, Noise_Proc) %>%
summarise(mean_balanced_accuracy = mean(balanced_accuracy, na.rm=T),
mean_SD = sd(balanced_accuracy, na.rm=T)) %>%
dplyr::rename("balanced_accuracy" = "mean_balanced_accuracy") %>%
left_join(., UCLA_SPI_pvals) %>%
ungroup() %>%
mutate(grouping_var = fct_reorder(grouping_var,
balanced_accuracy,
.fun = mean))
# ABIDE ASD
ABIDE_SPI_main <- ABIDE_SPI_main_repeats %>%
group_by(grouping_var, Sample_Type, Noise_Proc) %>%
summarise(mean_balanced_accuracy = mean(balanced_accuracy, na.rm=T),
mean_SD = sd(balanced_accuracy, na.rm=T)) %>%
dplyr::rename("balanced_accuracy" = "mean_balanced_accuracy") %>%
left_join(., ABIDE_SPI_pvals) %>%
ungroup() %>%
mutate(grouping_var = fct_reorder(grouping_var,
balanced_accuracy,
.fun = mean))
plot_boxplot_shaded_null(dataset_ID = "UCLA_Schizophrenia",
grouping_var_name = "SPI",
main_data_by_repeat = UCLA_SPI_main_repeats,
fill_color = "chartreuse3",
null_mean_value = mean(UCLA_SPI_null$balanced_accuracy, na.rm=T),
null_SD_value = sd(UCLA_SPI_null$balanced_accuracy, na.rm=T))
UCLA_SPI_main_repeats <- UCLA_SPI_main_full %>%
group_by(grouping_var, Sample_Type, Noise_Proc, repeat_number) %>%
summarise(mean_balanced_accuracy = mean(balanced_accuracy, na.rm=T)) %>%
dplyr::rename("balanced_accuracy" = "mean_balanced_accuracy") %>%
left_join(., UCLA_SPI_pvals) %>%
filter(bal_acc_p_adj < 0.05) %>%
ungroup() %>%
mutate(grouping_var = fct_reorder(grouping_var,
balanced_accuracy,
.fun = mean))
# ABIDE ASD
ABIDE_SPI_main_repeats <- ABIDE_SPI_main_full %>%
group_by(grouping_var, Sample_Type, Noise_Proc, repeat_number) %>%
summarise(mean_balanced_accuracy = mean(balanced_accuracy, na.rm=T)) %>%
dplyr::rename("balanced_accuracy" = "mean_balanced_accuracy") %>%
left_join(., ABIDE_SPI_pvals) %>%
filter(bal_acc_p_adj < 0.05) %>%
ungroup() %>%
mutate(grouping_var = fct_reorder(grouping_var,
balanced_accuracy,
.fun = mean))
plot_boxplot_shaded_null(dataset_ID = "UCLA_Schizophrenia",
grouping_var_name = "SPI",
main_data_by_repeat = UCLA_SPI_main_repeats,
fill_color = "chartreuse3",
null_mean_value = mean(UCLA_SPI_null$balanced_accuracy, na.rm=T),
null_SD_value = sd(UCLA_SPI_null$balanced_accuracy, na.rm=T))
plot_boxplot_shaded_null(dataset_ID = "UCLA_Schizophrenia",
grouping_var_name = "Pairwise SPI",
main_data_by_repeat = UCLA_SPI_main_repeats,
fill_color = "chartreuse3",
null_mean_value = mean(UCLA_SPI_null$balanced_accuracy, na.rm=T),
null_SD_value = sd(UCLA_SPI_null$balanced_accuracy, na.rm=T))
plot_boxplot_shaded_null(dataset_ID = "UCLA_Schizophrenia",
grouping_var_name = "Pairwise SPI",
main_data_by_repeat = UCLA_SPI_main_repeats,
fill_color = "chartreuse3",
null_mean_value = mean(UCLA_SPI_null$balanced_accuracy, na.rm=T),
null_SD_value = sd(UCLA_SPI_null$balanced_accuracy, na.rm=T))
ggsave(paste0(plot_path, "Figure3/UCLA_Schizophrenia_SPI_sig_boxplot.png"),
width = 8, height = 2.5, units="in", dpi=300)
plot_boxplot_shaded_null(dataset_ID = "ABIDE_ASD",
grouping_var_name = "Pairwise SPI",
main_data_by_repeat = ABIDE_SPI_main_repeats,
fill_color = "chartreuse3",
null_mean_value = mean(ABIDE_SPI_null$balanced_accuracy, na.rm=T),
null_SD_value = sd(ABIDE_SPI_null$balanced_accuracy, na.rm=T))
ggsave(paste0(plot_path, "Figure3/ABIDE_ASD_SPI_sig_boxplot.png"),
width = 8, height = 2.5, units="in", dpi=300)
plot_boxplot_shaded_null <- function(dataset_ID,
grouping_var_name,
main_data_by_repeat,
fill_color,
null_mean_value,
wrap_length = 20,
null_SD_value) {
ggplot() +
geom_boxplot(data = main_data_by_repeat %>%
mutate(grouping_var = str_replace_all(grouping_var, "ctx-lh-|Left-", "Left ")) %>%
mutate(grouping_var = str_replace_all(grouping_var, "ctx-rh-|Right-", "Right ")) %>%
mutate(grouping_var = fct_reorder(grouping_var,
balanced_accuracy,
.fun = mean)),
aes(y=grouping_var, x=balanced_accuracy),
fill = fill_color, color="black") +
geom_rect(data = main_data_by_repeat,
xmin = null_mean_value - null_SD_value,
xmax = null_mean_value + null_SD_value,
ymin=0, ymax=Inf, fill="gray85") +
geom_vline(xintercept = null_mean_value) +
scale_x_continuous(limits = c(0.975*(null_mean_value - null_SD_value),
1.025*max(main_data_by_repeat %>%
filter(bal_acc_p_adj < 0.05) %>%
pull(balanced_accuracy))),
breaks = scales::breaks_pretty(n = 4)) +
scale_y_discrete(labels = function(x) str_wrap(x, width = wrap_length)) +
xlab("Balanced Accuracy") +
ylab(grouping_var_name)
}
plot_boxplot_shaded_null(dataset_ID = "UCLA_Schizophrenia",
grouping_var_name = "Pairwise SPI",
main_data_by_repeat = UCLA_SPI_main_repeats,
fill_color = "chartreuse3",
wrap_length = 100,
null_mean_value = mean(UCLA_SPI_null$balanced_accuracy, na.rm=T),
null_SD_value = sd(UCLA_SPI_null$balanced_accuracy, na.rm=T))
ggsave(paste0(plot_path, "Figure3/UCLA_Schizophrenia_SPI_sig_boxplot.png"),
width = 8, height = 2.5, units="in", dpi=300)
# ABIDE ASD
plot_boxplot_shaded_null(dataset_ID = "ABIDE_ASD",
grouping_var_name = "Pairwise SPI",
main_data_by_repeat = ABIDE_SPI_main_repeats,
fill_color = "chartreuse3",
wrap_length = 100,
null_mean_value = mean(ABIDE_SPI_null$balanced_accuracy, na.rm=T),
null_SD_value = sd(ABIDE_SPI_null$balanced_accuracy, na.rm=T))
ggsave(paste0(plot_path, "Figure3/ABIDE_ASD_SPI_sig_boxplot.png"),
width = 8, height = 2.5, units="in", dpi=300)
UCLA_SPI_combo_pvals <- readRDS(paste0(UCLA_rdata_path, "univariate_catch22_pairwise_pyspi14_CV_linear_SVM_model_permutation_null_inv_prob_pvals.Rds")) %>%
filter(Noise_Proc == "AROMA+2P+GMR") %>%
ungroup() %>%
mutate(bal_acc_p_adj_bonf = p.adjust(bal_acc_p, method="bonferroni")) %>%
dplyr::select(grouping_var, bal_acc_p, bal_acc_p_adj, bal_acc_p_adj_bonf)
# ABIDE ASD
ABIDE_SPI_combo_pvals <- readRDS(paste0(ABIDE_rdata_path, "univariate_catch22_pairwise_pyspi14_CV_linear_SVM_model_permutation_null_inv_prob_pvals.Rds")) %>%
filter(Noise_Proc == "FC1000") %>%
ungroup() %>%
mutate(bal_acc_p_adj_bonf = p.adjust(bal_acc_p, method="bonferroni")) %>%
dplyr::select(grouping_var, bal_acc_p, bal_acc_p_adj, bal_acc_p_adj_bonf)
UCLA_SPI_combo_main_full <- readRDS(paste0(UCLA_rdata_path, "univariate_catch22_pairwise_pyspi14_CV_linear_SVM_inv_prob_balacc.Rds"))%>%
filter(Noise_Proc == "AROMA+2P+GMR")
# ABIDE ASD
ABIDE_SPI_combo_main_full <- readRDS(paste0(ABIDE_rdata_path, "univariate_catch22_pairwise_pyspi14_CV_linear_SVM_inv_prob_balacc.Rds")) %>%
filter(Noise_Proc == "FC1000")
UCLA_SPI_combo_main_repeats <- UCLA_SPI_combo_main_full %>%
group_by(grouping_var, Sample_Type, Noise_Proc, repeat_number) %>%
summarise(mean_balanced_accuracy = mean(balanced_accuracy, na.rm=T)) %>%
dplyr::rename("balanced_accuracy" = "mean_balanced_accuracy") %>%
left_join(., UCLA_SPI_pvals) %>%
filter(bal_acc_p_adj < 0.05) %>%
ungroup() %>%
mutate(grouping_var = fct_reorder(grouping_var,
balanced_accuracy,
.fun = mean))
View(ABIDE_SPI_combo_pvals)
UCLA_SPI_combo_main_full %>%
group_by(grouping_var, Sample_Type, Noise_Proc, repeat_number)
UCLA_SPI_combo_main_full
UCLA_SPI_combo_main_full <- readRDS(paste0(UCLA_rdata_path, "univariate_catch22_pairwise_pyspi14_CV_linear_SVM_inv_prob_balacc.Rds"))%>%
filter(Noise_Proc == "AROMA+2P+GMR") %>%
dplyr::rename("grouping_var" = "SPI")
# ABIDE ASD
ABIDE_SPI_combo_main_full <- readRDS(paste0(ABIDE_rdata_path, "univariate_catch22_pairwise_pyspi14_CV_linear_SVM_inv_prob_balacc.Rds")) %>%
filter(Noise_Proc == "FC1000") %>%
dplyr::rename("grouping_var" = "SPI")
UCLA_SPI_combo_main_full %>%
group_by(grouping_var, Sample_Type, Noise_Proc, repeat_number) %>%
summarise(mean_balanced_accuracy = mean(balanced_accuracy, na.rm=T)) %>%
dplyr::rename("balanced_accuracy" = "mean_balanced_accuracy") %>%
left_join(., UCLA_SPI_pvals) %>%
filter(bal_acc_p_adj < 0.05) %>%
ungroup() %>%
mutate(grouping_var = fct_reorder(grouping_var,
balanced_accuracy,
.fun = mean))
# UCLA Schizophrenia
UCLA_SPI_combo_main_repeats <- UCLA_SPI_combo_main_full %>%
group_by(grouping_var, Sample_Type, Noise_Proc, repeat_number) %>%
summarise(mean_balanced_accuracy = mean(balanced_accuracy, na.rm=T)) %>%
dplyr::rename("balanced_accuracy" = "mean_balanced_accuracy") %>%
left_join(., UCLA_SPI_pvals) %>%
filter(bal_acc_p_adj < 0.05) %>%
ungroup() %>%
mutate(grouping_var = fct_reorder(grouping_var,
balanced_accuracy,
.fun = mean))
# ABIDE ASD
ABIDE_SPI_combo_main_repeats <- ABIDE_SPI_combo_main_full %>%
group_by(grouping_var, Sample_Type, Noise_Proc, repeat_number) %>%
summarise(mean_balanced_accuracy = mean(balanced_accuracy, na.rm=T)) %>%
dplyr::rename("balanced_accuracy" = "mean_balanced_accuracy") %>%
left_join(., ABIDE_SPI_pvals) %>%
filter(bal_acc_p_adj < 0.05) %>%
ungroup() %>%
mutate(grouping_var = fct_reorder(grouping_var,
balanced_accuracy,
.fun = mean))
UCLA_SPI_combo_main_repeats <- UCLA_SPI_combo_main_full %>%
group_by(grouping_var, Sample_Type, Noise_Proc, repeat_number) %>%
summarise(mean_balanced_accuracy = mean(balanced_accuracy, na.rm=T)) %>%
dplyr::rename("balanced_accuracy" = "mean_balanced_accuracy") %>%
left_join(., UCLA_SPI_combo_pvals) %>%
filter(bal_acc_p_adj < 0.05) %>%
ungroup() %>%
mutate(grouping_var = fct_reorder(grouping_var,
balanced_accuracy,
.fun = mean))
# ABIDE ASD
ABIDE_SPI_combo_main_repeats <- ABIDE_SPI_combo_main_full %>%
group_by(grouping_var, Sample_Type, Noise_Proc, repeat_number) %>%
summarise(mean_balanced_accuracy = mean(balanced_accuracy, na.rm=T)) %>%
dplyr::rename("balanced_accuracy" = "mean_balanced_accuracy") %>%
left_join(., ABIDE_SPI_combo_pvals) %>%
filter(bal_acc_p_adj < 0.05) %>%
ungroup() %>%
mutate(grouping_var = fct_reorder(grouping_var,
balanced_accuracy,
.fun = mean))
UCLA_SPI_combo_main <- UCLA_SPI_combo_main_repeats %>%
group_by(grouping_var, Sample_Type, Noise_Proc) %>%
summarise(mean_balanced_accuracy = mean(balanced_accuracy, na.rm=T),
mean_SD = sd(balanced_accuracy, na.rm=T)) %>%
dplyr::rename("balanced_accuracy" = "mean_balanced_accuracy") %>%
left_join(., UCLA_SPI_combo_pvals) %>%
ungroup() %>%
mutate(grouping_var = fct_reorder(grouping_var,
balanced_accuracy,
.fun = mean))
# ABIDE ASD
ABIDE_SPI_combo_main <- ABIDE_SPI_combo_main_repeats %>%
group_by(grouping_var, Sample_Type, Noise_Proc) %>%
summarise(mean_balanced_accuracy = mean(balanced_accuracy, na.rm=T),
mean_SD = sd(balanced_accuracy, na.rm=T)) %>%
dplyr::rename("balanced_accuracy" = "mean_balanced_accuracy") %>%
left_join(., ABIDE_SPI_combo_pvals) %>%
ungroup() %>%
mutate(grouping_var = fct_reorder(grouping_var,
balanced_accuracy,
.fun = mean))
View(UCLA_SPI_combo_main)
library(tidyverse)
library(ggseg3d)
library(icesTAF)
library(cowplot)
theme_set(theme_cowplot())
github_dir <- "~/github/fMRI_FeaturesDisorders/"
plot_path <- paste0(github_dir, "plots/Manuscript_Draft/")
icesTAF::mkdir(plot_path)
icesTAF::mkdir(paste0(plot_path, "Figure1/"))
# Brain figure
data.frame(
region = c("inferior parietal",
"rostral middle frontal"),
p = c(0, 1),
stringsAsFactors = F) %>%
ggseg3d(colour = "p", text = "p",
palette = c("deepskyblue2" = 0 ,
"darkorange2" = 1),
show.legend=F) %>%
remove_axes() %>%
pan_camera("left medial")
# TS line plots
set.seed(127)
ar.sim1<-arima.sim(model=list(ar=c(.9,-.2)),n=80)
ar.sim2 <- arima.sim(model=list(ar=c(0.3, 0.1)), n=80)
#Our transformation function
scaleFUN <- function(x) sprintf("%.1f", x)
# Inferior parietal (blue)
data.frame(Time = 1:length(ar.sim1),
BOLD = as.numeric(ar.sim1),
Time_Series = "TS1") %>%
ggplot(data=., mapping=aes(x=Time, y=BOLD, color=Time_Series)) +
geom_line(size=0.6, alpha=0.9) +
scale_color_manual(values=c("deepskyblue2")) +
scale_y_continuous(labels=scaleFUN) +
theme(legend.position="none")
ggsave(paste0(plot_path, "Figure1/BOLD_TS_blue.png"), width=2.3, height=1.8,
units="in", dpi=1200, bg = "transparent")
# Rostral middle frontal (orange)
data.frame(Time = 1:length(ar.sim2),
BOLD = as.numeric(ar.sim2),
Time_Series = "TS2") %>%
ggplot(data=., mapping=aes(x=Time, y=BOLD, color=Time_Series)) +
geom_line(size=0.6, alpha=0.9) +
scale_color_manual(values=c("darkorange2")) +
scale_y_continuous(labels=scaleFUN) +
theme(legend.position="none")
ggsave(paste0(plot_path, "Figure1/BOLD_TS_orange.png"), width=2.3, height=1.8,
units="in", dpi=1200, bg = "transparent")
# Plots together
data.frame(Time = c(1:length(ar.sim1), 1:length(ar.sim2)),
BOLD = c(as.numeric(ar.sim1), as.numeric(ar.sim2)),
Time_Series = c(rep("TS1", length(ar.sim1)),
rep("TS2", length(ar.sim2)))) %>%
ggplot(data=., mapping=aes(x=Time, y=BOLD, color=Time_Series)) +
geom_line(size=0.6, alpha=0.9) +
scale_color_manual(values=c("deepskyblue2", "darkorange2")) +
scale_y_continuous(labels=scaleFUN) +
theme(legend.position="none")
ggsave(paste0(plot_path, "Figure1/BOLD_TS_both.png"), width=2.3, height=1.8,
units="in", dpi=1200, bg = "transparent")
setwd("~/github/fMRI_FeaturesDisorders/data_visualisation/manuscript_figures")
github_dir <- "~/github/fMRI_FeaturesDisorders/"
plot_path <- paste0(github_dir, "plots/Manuscript_Draft/")
icesTAF::mkdir(plot_path)
SCZ_data_path <- "~/data/UCLA_Schizophrenia/"
SCZ_rdata_path <- paste0(SCZ_data_path, "processed_data/Rdata/")
ASD_data_path <- "~/data/ABIDE_ASD/"
ASD_rdata_path <- paste0(ASD_data_path, "processed_data/Rdata/")
raw_ASD_pyspi_res <- readRDS(paste0(ASD_rdata_path, "ABIDE_ASD_pyspi14_filtered.Rds"))
# Get number of brain region pairs
raw_ASD_pyspi_res %>%
filter(brain_region_1 != brain_region_2) %>%
distinct(brain_region_1, brain_region_2) %>%
nrow()
sgc_res <- raw_ASD_pyspi_res %>%
filter(brain_region_1 != brain_region_2) %>%
filter(SPI=="sgc_nonparametric_mean_fs-1_fmin-0_fmax-0-5")
sgc_res_NA <-  sgc_res %>%
filter(is.na(value))
sgc_res_NA %>%
distinct(brain_region_1, brain_region_2)
sgc_res_NA %>%
mutate(region_pair = paste0(brain_region_1, "_", brain_region_2)) %>%
ggplot(data=., mapping=aes(x=region_pair, y=Sample_ID, fill=value)) +
geom_tile() +
theme(axis.text = element_blank(),
legend.position = "none")
sgc_res_NA %>%
mutate(region_pair = paste0(brain_region_1, "_", brain_region_2),) %>%
ggplot(data=., mapping=aes(x=region_pair, y=Sample_ID, fill=value)) +
scale_fill_gradient(low="white", high="white", na.value = "red") +
geom_tile() +
theme(axis.text = element_blank(),
legend.position = "none")
