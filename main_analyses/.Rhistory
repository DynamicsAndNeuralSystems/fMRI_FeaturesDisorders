univariate_feature_set <- "catch22"
subject_csv <- "participants.csv"
project_path <- "D:/Virtual_Machines/Shared_Folder/github/"
pydata_path <- "D:/Virtual_Machines/Shared_Folder/PhD_work/data/UCLA_Schizophrenia/pydata/"
data_path <- "D:/Virtual_Machines/Shared_Folder/PhD_work/data/UCLA_Schizophrenia/"
dataset_ID <- "UCLA_Schizophrenia"
noise_procs <- c("AROMA+2P", "AROMA+2P+GMR", "AROMA+2P+DiCER")
pairwise_feature_set <- "pyspi_19"
brain_region_lookup <- "Brain_Region_info.csv"
# univariate_feature_set <- "catch22"
sample_metadata <- "participants.csv"
pydata_path <- "/headnode1/abry4213/data/UCLA_Schizophrenia/pydata/"
data_path <- "/headnode1/abry4213/data/UCLA_Schizophrenia/"
dataset_ID <- "UCLA_Schizophrenia"
noise_procs <- c("AROMA+2P", "AROMA+2P+GMR", "AROMA+2P+DiCER")
pairwise_feature_set <- "pyspi_19"
brain_region_lookup <- "Brain_Region_info.csv"
# univariate_feature_set <- "catch22"
# sample_metadata <- "participants.csv"
project_path <- "/headnode1/abry4213/"
pairwise_feature_set <- "pyspi_19"
if (!(file.exists(paste0(pydata_path, dataset_ID, "_pairwise_",
pairwise_feature_set, ".Rds")))) {
full_res <- noise_procs %>%
purrr::map_df(~ readRDS(paste0(pydata_path, gsub("\\+", "_", .x),
"_pairwise_",
pairwise_feature_set, ".Rds"))) %>%
left_join(., sample_metadata_df) %>%
dplyr::filter(Diagnosis %in% label_vars)
saveRDS(full_res,
paste0(pydata_path, dataset_ID, "_pairwise_",
pairwise_feature_set, ".Rds"))
}
library(tidyverse)
library(purrr)
# Read in brain region lookup table
brain_region_LUT <- read.csv(paste0(data_path, brain_region_lookup)) %>%
mutate(Index = as.numeric(Index))
# Load sample info
sample_metadata_df <- read.csv(paste0(data_path, sample_metadata)) %>%
mutate(Sample_ID == gsub("_", "", Sample_ID))
# UCLA schizophrenia
# pydata_path <- "/headnode1/abry4213/data/UCLA_Schizophrenia/pydata/"
# data_path <- "/headnode1/abry4213/data/UCLA_Schizophrenia/"
# dataset_ID <- "UCLA_Schizophrenia"
# noise_procs <- c("AROMA+2P", "AROMA+2P+GMR", "AROMA+2P+DiCER")
# pairwise_feature_set <- "pyspi_19"
# brain_region_lookup <- "Brain_Region_info.csv"
label_vars <- c("CONTROL", "SCHIZOPHRENIA")
# Merge all pairwise data for subjects in user-specified groups
if (!(file.exists(paste0(pydata_path, dataset_ID, "_pairwise_",
pairwise_feature_set, ".Rds")))) {
full_res <- noise_procs %>%
purrr::map_df(~ readRDS(paste0(pydata_path, gsub("\\+", "_", .x),
"_pairwise_",
pairwise_feature_set, ".Rds"))) %>%
left_join(., sample_metadata_df) %>%
dplyr::filter(Diagnosis %in% label_vars)
saveRDS(full_res,
paste0(pydata_path, dataset_ID, "_pairwise_",
pairwise_feature_set, ".Rds"))
}
pydata_path <- "/headnode1/abry4213/data/ABIDE_ASD/pydata/"
data_path <- "/headnode1/abry4213/data/ABIDE_ASD/"
dataset_ID <- "ABIDE_ASD"
noise_procs <- c("FC1000")
pairwise_feature_set <- "pyspi_19"
brain_region_lookup <- "Harvard_Oxford_cort_prob_2mm_ROI_lookup.csv"
# ABIDE ASD
# pydata_path <- "/headnode1/abry4213/data/ABIDE_ASD/pydata/"
# data_path <- "/headnode1/abry4213/data/ABIDE_ASD/"
# dataset_ID <- "ABIDE_ASD"
# noise_procs <- c("FC1000")
# pairwise_feature_set <- "pyspi_19"
# brain_region_lookup <- "Harvard_Oxford_cort_prob_2mm_ROI_lookup.csv"
label_vars = c("Control", "ASD")
brain_region_LUT <- read.csv(paste0(data_path, brain_region_lookup)) %>%
mutate(Index = as.numeric(Index))
# Load sample info
sample_metadata_df <- read.csv(paste0(data_path, sample_metadata)) %>%
mutate(Sample_ID == gsub("_", "", Sample_ID))
# Merge all pairwise data for subjects in user-specified groups
if (!(file.exists(paste0(pydata_path, dataset_ID, "_pairwise_",
pairwise_feature_set, ".Rds")))) {
full_res <- noise_procs %>%
purrr::map_df(~ readRDS(paste0(pydata_path, gsub("\\+", "_", .x),
"_pairwise_",
pairwise_feature_set, ".Rds"))) %>%
left_join(., sample_metadata_df) %>%
dplyr::filter(Diagnosis %in% label_vars)
saveRDS(full_res,
paste0(pydata_path, dataset_ID, "_pairwise_",
pairwise_feature_set, ".Rds"))
}
View(sample_metadata_df)
sample_metadata_df <- read.csv(paste0(data_path, sample_metadata)) %>%
mutate(Sample_ID = gsub("_", "", Sample_ID)) %>%
dplyr::filter(Diagnosis %in% label_vars)
full_res <- noise_procs %>%
purrr::map_df(~ readRDS(paste0(pydata_path, gsub("\\+", "_", .x),
"_pairwise_",
pairwise_feature_set, ".Rds"))) %>%
left_join(., sample_metadata_df) %>%
dplyr::filter(Diagnosis %in% label_vars)
saveRDS(full_res,
paste0(pydata_path, dataset_ID, "_pairwise_",
pairwise_feature_set, ".Rds"))
pydata_path <- "/headnode1/abry4213/data/UCLA_Schizophrenia/pydata/"
data_path <- "/headnode1/abry4213/data/UCLA_Schizophrenia/"
dataset_ID <- "UCLA_Schizophrenia"
noise_procs <- c("AROMA+2P", "AROMA+2P+GMR", "AROMA+2P+DiCER")
pairwise_feature_set <- "pyspi_19"
brain_region_lookup <- "Brain_Region_info.csv"
label_vars <- c("CONTROL", "SCHIZOPHRENIA")
brain_region_LUT <- read.csv(paste0(data_path, brain_region_lookup)) %>%
mutate(Index = as.numeric(Index))
# Load sample info
sample_metadata_df <- read.csv(paste0(data_path, sample_metadata)) %>%
mutate(Sample_ID = gsub("_", "", Sample_ID)) %>%
dplyr::filter(Diagnosis %in% label_vars)
# UCLA schizophrenia
# pydata_path <- "/headnode1/abry4213/data/UCLA_Schizophrenia/pydata/"
# data_path <- "/headnode1/abry4213/data/UCLA_Schizophrenia/"
# dataset_ID <- "UCLA_Schizophrenia"
# noise_procs <- c("AROMA+2P", "AROMA+2P+GMR", "AROMA+2P+DiCER")
# pairwise_feature_set <- "pyspi_19"
# brain_region_lookup <- "Brain_Region_info.csv"
label_vars <- c("CONTROL", "SCHZ")
sample_metadata_df <- read.csv(paste0(data_path, sample_metadata)) %>%
mutate(Sample_ID = gsub("_", "", Sample_ID)) %>%
dplyr::select(Sample_ID, Diagnosis) %>%
dplyr::filter(Diagnosis %in% label_vars)
full_res <- noise_procs %>%
purrr::map_df(~ readRDS(paste0(pydata_path, gsub("\\+", "_", .x),
"_pairwise_",
pairwise_feature_set, ".Rds"))) %>%
left_join(., sample_metadata_df)
saveRDS(full_res,
paste0(pydata_path, dataset_ID, "_pairwise_",
pairwise_feature_set, ".Rds"))
length(unique(full_res$Sample_ID))
full_res <- noise_procs %>%
purrr::map_df(~ readRDS(paste0(pydata_path, gsub("\\+", "_", .x),
"_pairwise_",
pairwise_feature_set, ".Rds"))) %>%
semi_join(., sample_metadata_df) %>%
left_join(., sample_metadat_df)
full_res <- noise_procs %>%
purrr::map_df(~ readRDS(paste0(pydata_path, gsub("\\+", "_", .x),
"_pairwise_",
pairwise_feature_set, ".Rds"))) %>%
semi_join(., sample_metadata_df) %>%
left_join(., sample_metadata_df)
saveRDS(full_res,
paste0(pydata_path, dataset_ID, "_pairwise_",
pairwise_feature_set, ".Rds"))
length(unique(full_res$Sample_ID))
pydata_path <- "/headnode1/abry4213/data/ABIDE_ASD/pydata/"
data_path <- "/headnode1/abry4213/data/ABIDE_ASD/"
dataset_ID <- "ABIDE_ASD"
noise_procs <- c("FC1000")
pairwise_feature_set <- "pyspi_19"
brain_region_lookup <- "Harvard_Oxford_cort_prob_2mm_ROI_lookup.csv"
label_vars = c("Control", "ASD")
# Read in brain region lookup table
brain_region_LUT <- read.csv(paste0(data_path, brain_region_lookup)) %>%
mutate(Index = as.numeric(Index))
# Load sample info
sample_metadata_df <- read.csv(paste0(data_path, sample_metadata)) %>%
mutate(Sample_ID = gsub("_", "", Sample_ID)) %>%
dplyr::select(Sample_ID, Diagnosis) %>%
dplyr::filter(Diagnosis %in% label_vars)
pydata_path <- "/headnode1/abry4213/data/UCLA_Schizophrenia/pydata/"
data_path <- "/headnode1/abry4213/data/UCLA_Schizophrenia/"
dataset_ID <- "UCLA_Schizophrenia"
noise_procs <- c("AROMA+2P", "AROMA+2P+GMR", "AROMA+2P+DiCER")
pairwise_feature_set <- "pyspi_19"
brain_region_lookup <- "Brain_Region_info.csv"
label_vars <- c("CONTROL", "SCHZ")
full_res %>%
distinct(Sample_ID, Diagnosis) %>%
write.csv(., paste0(data_path,
dataset_ID,
"_samples_with_pyspi.csv"),
row.names = F)
pydata_path <- "/headnode1/abry4213/data/ABIDE_ASD/pydata/"
data_path <- "/headnode1/abry4213/data/ABIDE_ASD/"
dataset_ID <- "ABIDE_ASD"
noise_procs <- c("FC1000")
pairwise_feature_set <- "pyspi_19"
brain_region_lookup <- "Harvard_Oxford_cort_prob_2mm_ROI_lookup.csv"
label_vars = c("Control", "ASD")
brain_region_LUT <- read.csv(paste0(data_path, brain_region_lookup)) %>%
mutate(Index = as.numeric(Index))
# Load sample info
sample_metadata_df <- read.csv(paste0(data_path, sample_metadata)) %>%
mutate(Sample_ID = gsub("_", "", Sample_ID)) %>%
dplyr::select(Sample_ID, Diagnosis) %>%
dplyr::filter(Diagnosis %in% label_vars)
full_res <- noise_procs %>%
purrr::map_df(~ readRDS(paste0(pydata_path, gsub("\\+", "_", .x),
"_pairwise_",
pairwise_feature_set, ".Rds"))) %>%
semi_join(., sample_metadata_df) %>%
left_join(., sample_metadata_df)
saveRDS(full_res,
paste0(pydata_path, dataset_ID, "_pairwise_",
pairwise_feature_set, ".Rds"))
# Write subjects with pairwise data to a CSV file
full_res %>%
distinct(Sample_ID, Diagnosis) %>%
write.csv(., paste0(data_path,
dataset_ID,
"_samples_with_pyspi.csv"),
row.names = F)
