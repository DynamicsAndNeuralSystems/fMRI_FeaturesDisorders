---
title: "Subset one subject"
author: "Annie Bryant"
date: "5/18/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyverse)
library(theft)
library(reticulate)
rdata_path <- "/media/sf_Shared_Folder/PhD_work/data/scz/UCLA/Rdata/"
```

Take the first subject in the dataset
```{r}
AROMA_2P <- readRDS(paste0(rdata_path, "UCLA_AROMA_2P.Rds"))
first_subject <- unique(AROMA_2P$Subject_ID)[1]

first_subject_data <- subset(AROMA_2P, Subject_ID == first_subject)

# Save to a new RDS file
saveRDS(first_subject_data, paste0(rdata_path, "UCLA_AROMA_2P_First_Subject.Rds"))
```


Test running theft for one subject locally
```{r}
first_subject_data <- readRDS(paste0(rdata_path, "UCLA_AROMA_2P_First_Subject.Rds"))
first_subject_theft <- theft::calculate_features(data = first_subject_data, 
                                              id_var = "Brain_Region", 
                                              time_var = "timepoint", 
                                              values_var = "value", 
                                              group_var = "diagnosis", 
                                              feature_set = "tsfel",
                                              catch24 = F)
# saveRDS(first_subject_theft, paste0(rdata_path, "UCLA_AROMA_2P_First_Subject_theft.Rds"))
```

